<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Add Payment Method</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#47b4eb",
                        "background-light": "#f6f7f8",
                        "background-dark": "#111c21",
                    },
                    fontFamily: {
                        "display": ["Manrope"]
                    },
                    borderRadius: {"DEFAULT": "0.5rem", "lg": "1rem", "xl": "1.5rem", "full": "9999px"},
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .tab-content {
            transition: opacity 0.2s ease-in-out;
        }
        /* Pulse animation for low time */
        @keyframes pulse-red {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .timer-warning {
            color: #ef4444;
            animation: pulse-red 1s infinite;
        }
    </style>
</head>
<body class="bg-slate-200 dark:bg-background-dark/90 font-display">
    <div class="fixed inset-0 z-0 overflow-hidden">
        <img alt="" class="w-full h-full object-cover blur-sm opacity-50" data-alt="Blurred background of an airplane wing over clouds" src="https://lh3.googleusercontent.com/aida-public/AB6AXuAfPRRZJMoQrnAGaY0dss1fcQrmKFmOZe6MSOdJKs_ONHveqtjLaQIYe7UDPpa7KDuL3g1VfvZViP55erCX9fcp4-j9LjlwTvo7OT-xLdQKcJYqFEZRJT_YDghQk6RbUzd3vCogHKkCoMZCR0s33cD1tGr80jGzUfPaFcKOuXilbfvPTj8tZEfwJubrzg2woQtUvwICucA6oPmnVyW3vaNRSvGfQQhJW01hIXx7wV8zlmKkDlIZ9xIwVa8ooTnr7V6yu2r3hX61NgIz"/>
    </div>
    
    <div class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/40 backdrop-blur-sm">
        <div class="bg-white dark:bg-[#1a262e] w-full max-w-[600px] rounded-xl shadow-2xl overflow-hidden flex flex-col relative">
            
            <div class="px-6 py-4 border-b border-[#dce2e5] dark:border-slate-700 flex justify-between items-center">
                <div>
                    <h2 id="paymentHeader" class="text-xl font-bold text-[#111518] dark:text-white">Add payment method</h2>
                    <p class="text-xs text-slate-500 font-medium mt-1">Transaction ID: <span class="font-mono text-slate-400">TXN882910</span></p>
                </div>
                
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-1.5 bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 px-3 py-1.5 rounded-full border border-orange-100 dark:border-orange-900/30">
                        <span class="material-symbols-outlined text-sm">timer</span>
                        <span id="sessionTimer" class="text-xs font-bold font-mono">10:00</span>
                    </div>

                    <button onclick="cancelPayment()" class="group p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors" title="Cancel Payment">
                        <span class="material-symbols-outlined text-[#637c88] group-hover:text-red-500 transition-colors">close</span>
                    </button>
                </div>
            </div>

            <div class="px-6">
                <div class="flex border-b border-[#dce2e5] dark:border-slate-700 gap-8">
                    <button onclick="switchTab('card')" id="tab-card" class="flex flex-col items-center justify-center border-b-[3px] border-b-primary text-primary pb-[13px] pt-4 transition-all w-1/2">
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-sm">credit_card</span>
                            <p class="text-sm font-bold leading-normal tracking-[0.015em]">Credit/Debit Card</p>
                        </div>
                    </button>
                    <button onclick="switchTab('upi')" id="tab-upi" class="flex flex-col items-center justify-center border-b-[3px] border-b-transparent text-[#637c88] pb-[13px] pt-4 transition-all w-1/2">
                        <div class="flex items-center gap-2">
                            <span class="material-symbols-outlined text-sm">account_balance_wallet</span>
                            <p class="text-sm font-bold leading-normal tracking-[0.015em]">UPI</p>
                        </div>
                    </button>
                </div>
            </div>

            <div class="p-6 overflow-y-auto max-h-[70vh]">
                
                <div id="section-card" class="flex flex-col gap-4 tab-content">
                    <div class="flex flex-col gap-2">
                        <label class="flex flex-col w-full">
                            <p class="text-[#111518] dark:text-slate-200 text-sm font-medium leading-normal pb-2">Cardholder Name</p>
                            <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111518] dark:text-white dark:bg-slate-800 focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dce2e5] dark:border-slate-700 h-14 placeholder:text-[#637c88] p-[15px] text-base font-normal leading-normal transition-all" placeholder="John Doe" value=""/>
                        </label>
                    </div>
                    <div class="flex flex-col gap-2">
                        <label class="flex flex-col w-full">
                            <p class="text-[#111518] dark:text-slate-200 text-sm font-medium leading-normal pb-2">Card Number</p>
                            <div class="flex w-full items-stretch rounded-xl group">
                                <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111518] dark:text-white dark:bg-slate-800 focus:outline-0 focus:ring-0 border border-[#dce2e5] dark:border-slate-700 focus:border-[#dce2e5] h-14 placeholder:text-[#637c88] p-[15px] rounded-r-none border-r-0 pr-2 text-base font-normal leading-normal" placeholder="0000 0000 0000 0000" value=""/>
                                <div class="text-[#637c88] flex border border-[#dce2e5] dark:border-slate-700 bg-white dark:bg-slate-800 items-center justify-center pr-[15px] rounded-r-xl border-l-0">
                                    <span class="material-symbols-outlined">credit_card</span>
                                </div>
                            </div>
                        </label>
                    </div>
                    <div class="flex flex-wrap items-end gap-4">
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#111518] dark:text-slate-200 text-sm font-medium leading-normal pb-2">Expiry Date (MM/YY)</p>
                            <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111518] dark:text-white dark:bg-slate-800 focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-[#dce2e5] dark:border-slate-700 h-14 placeholder:text-[#637c88] p-[15px] text-base font-normal leading-normal transition-all" placeholder="MM/YY" value=""/>
                        </label>
                        <label class="flex flex-col min-w-40 flex-1">
                            <p class="text-[#111518] dark:text-slate-200 text-sm font-medium leading-normal pb-2">CVV</p>
                            <div class="flex w-full items-stretch rounded-xl">
                                <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111518] dark:text-white dark:bg-slate-800 focus:outline-0 focus:ring-0 border border-[#dce2e5] dark:border-slate-700 h-14 placeholder:text-[#637c88] p-[15px] rounded-r-none border-r-0 pr-2 text-base font-normal leading-normal" placeholder="123" value=""/>
                                <div class="text-[#637c88] flex border border-[#dce2e5] dark:border-slate-700 bg-white dark:bg-slate-800 items-center justify-center pr-[15px] rounded-r-xl border-l-0">
                                    <span class="material-symbols-outlined">help</span>
                                </div>
                            </div>
                        </label>
                    </div>
                    <div class="mt-4 @container">
                        <div class="flex flex-1 flex-col items-start justify-between gap-4 rounded-xl border border-[#dce2e5] dark:border-slate-700 bg-background-light dark:bg-slate-800/50 p-5 @[480px]:flex-row @[480px]:items-center transition-colors">
                            <div class="flex flex-col gap-1">
                                <p class="text-[#111518] dark:text-white text-base font-bold leading-tight">Save for future bookings</p>
                                <p class="text-[#637c88] dark:text-slate-400 text-sm font-normal leading-normal">Securely save your card details for faster checkout.</p>
                            </div>
                            <label class="relative flex h-[31px] w-[51px] cursor-pointer items-center rounded-full border-none bg-slate-300 dark:bg-slate-600 p-0.5 has-[:checked]:justify-end has-[:checked]:bg-primary transition-all">
                                <div class="h-full w-[27px] rounded-full bg-white shadow-md"></div>
                                <input checked="" class="invisible absolute" type="checkbox"/>
                            </label>
                        </div>
                    </div>
                </div>

                <div id="section-upi" class="hidden flex-col gap-6 tab-content">
                    <div class="flex flex-col gap-2">
                        <label class="flex flex-col w-full">
                            <p class="text-[#111518] dark:text-slate-200 text-sm font-medium leading-normal pb-2">Enter UPI ID</p>
                            <div class="flex w-full items-stretch rounded-xl group">
                                <input class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-xl text-[#111518] dark:text-white dark:bg-slate-800 focus:outline-0 focus:ring-0 border border-[#dce2e5] dark:border-slate-700 focus:border-[#dce2e5] h-14 placeholder:text-[#637c88] p-[15px] rounded-r-none border-r-0 pr-2 text-base font-normal leading-normal" placeholder="username@oksbi" value=""/>
                                <div class="text-[#637c88] flex border border-[#dce2e5] dark:border-slate-700 bg-white dark:bg-slate-800 items-center justify-center pr-[15px] rounded-r-xl border-l-0">
                                    <span class="material-symbols-outlined">alternate_email</span>
                                </div>
                            </div>
                            <p class="text-xs text-[#637c88] dark:text-slate-400 mt-2 ml-1">A payment request will be sent to this ID.</p>
                        </label>
                    </div>

                    <div class="flex items-center gap-4">
                        <div class="h-px bg-slate-200 dark:bg-slate-700 flex-1"></div>
                        <span class="text-xs font-bold text-slate-400">OR SCAN QR</span>
                        <div class="h-px bg-slate-200 dark:bg-slate-700 flex-1"></div>
                    </div>

                    <div class="flex flex-col items-center justify-center gap-4 p-6 border border-dashed border-slate-300 dark:border-slate-700 rounded-xl bg-slate-50 dark:bg-slate-800/50">
                        <div class="bg-white p-2 rounded-lg shadow-sm border border-slate-100">
                             <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=upi://pay?pa=travelgo@upi&pn=TravelGo&cu=INR" alt="QR Code" class="w-32 h-32">
                        </div>
                        <div class="text-center">
                            <p class="text-[#111518] dark:text-white font-bold text-sm">Scan to Pay</p>
                            <p class="text-xs text-[#637c88] dark:text-slate-400 mt-1">Open any UPI app (GPay, PhonePe, Paytm) and scan this code.</p>
                        </div>
                    </div>
                </div>

            </div>

            <div class="px-6 py-5 border-t border-[#dce2e5] dark:border-slate-700 flex flex-col gap-3">
                <button id="payButton" class="w-full bg-primary hover:bg-primary/90 text-white text-base font-bold h-14 rounded-xl flex items-center justify-center gap-2 transition-all shadow-lg shadow-primary/20">
                    <span class="material-symbols-outlined">lock</span>
                    Save Card & Continue
                </button>
                <p class="text-center text-[#637c88] text-xs font-normal">
                    Your payment information is processed securely using end-to-end encryption.
                </p>
            </div>
        </div>
    </div>
    
    <script>
        // --- Timer Logic ---
        function startTimer(duration, display) {
            let timer = duration, minutes, seconds;
            const interval = setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                display.textContent = minutes + ":" + seconds;

                if (timer <= 60) {
                    display.parentElement.classList.add('timer-warning');
                    display.parentElement.classList.replace('bg-orange-50', 'bg-red-50');
                    display.parentElement.classList.replace('text-orange-600', 'text-red-600');
                }

                if (--timer < 0) {
                    clearInterval(interval);
                    alert("Session Expired. Redirecting to home.");
                    window.location.href = 'travel.html';
                }
            }, 1000);
        }

        // --- Cancellation Logic ---
        function cancelPayment() {
            if(confirm("Are you sure you want to cancel the payment? Your booking will not be saved.")) {
                window.location.href = 'index.html'; // Redirects back to search
            }
        }

        // --- Tab Switching Logic ---
        function switchTab(tabName) {
            const cardSection = document.getElementById('section-card');
            const upiSection = document.getElementById('section-upi');
            const cardTab = document.getElementById('tab-card');
            const upiTab = document.getElementById('tab-upi');
            const payBtn = document.getElementById('payButton');
            
            // Get current amount text if it exists (e.g. "Pay ₹500")
            let currentBtnText = payBtn.innerText;
            const amountMatch = currentBtnText.match(/₹\d+/);
            const amountText = amountMatch ? amountMatch[0] : '';

            if (tabName === 'card') {
                // Show Card
                cardSection.classList.remove('hidden');
                cardSection.classList.add('flex');
                upiSection.classList.add('hidden');
                upiSection.classList.remove('flex');
                
                // Style Tabs
                cardTab.className = "flex flex-col items-center justify-center border-b-[3px] border-b-primary text-primary pb-[13px] pt-4 transition-all w-1/2 cursor-default";
                upiTab.className = "flex flex-col items-center justify-center border-b-[3px] border-b-transparent text-[#637c88] hover:text-[#111518] dark:hover:text-white pb-[13px] pt-4 transition-all w-1/2 cursor-pointer";

                // Update Button Text
                payBtn.innerHTML = `<span class="material-symbols-outlined">lock</span> ${amountText ? 'Pay ' + amountText : 'Save Card'} & Continue`;
            
            } else {
                // Show UPI
                upiSection.classList.remove('hidden');
                upiSection.classList.add('flex');
                cardSection.classList.add('hidden');
                cardSection.classList.remove('flex');

                // Style Tabs
                upiTab.className = "flex flex-col items-center justify-center border-b-[3px] border-b-primary text-primary pb-[13px] pt-4 transition-all w-1/2 cursor-default";
                cardTab.className = "flex flex-col items-center justify-center border-b-[3px] border-b-transparent text-[#637c88] hover:text-[#111518] dark:hover:text-white pb-[13px] pt-4 transition-all w-1/2 cursor-pointer";

                // Update Button Text
                payBtn.innerHTML = `<span class="material-symbols-outlined">verified_user</span> Verify & Pay ${amountText}`;
            }
        }

        // --- Init Logic ---
        window.onload = function() {
            // 1. Get Price
            const urlParams = new URLSearchParams(window.location.search);
            const amount = urlParams.get('amount');
            
            if (amount) {
                const header = document.getElementById('paymentHeader');
                if(header) header.textContent = `Pay ₹${amount}`;

                const btn = document.getElementById('payButton');
                if(btn) {
                    btn.innerHTML = `
                        <span class="material-symbols-outlined">lock</span>
                        Pay ₹${amount} & Continue
                    `;
                }
            }

            // 2. Start Timer (10 minutes)
            const display = document.querySelector('#sessionTimer');
            startTimer(600, display);
        };
    </script>
</body>
</html>
